<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ReviewHub ‚Äî Rate Spotify albums & singles (0-10)</title>
  <meta name="description" content="Search or paste Spotify links for albums and singles, rate them 0-10, and share reviews with the community.">
  <link rel="stylesheet" href="styles.css">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
</head>
<body>
  <!-- Login Modal -->
  <div id="loginModal" class="modal show">
    <div class="modal-content">
      <div class="modal-header">
        <div class="logo-small"></div>
        <h3>Welcome to ReviewHub</h3>
        <div class="sub">Rate and review your favorite albums & singles</div>
      </div>
      <div class="modal-body">
        <div class="auth-section">
          <div class="form-group">
            <label for="loginEmail">Email Address</label>
            <input id="loginEmail" type="email" placeholder="Enter your email" />
          </div>
          <div class="form-group">
            <label for="loginPassword">Password</label>
            <input id="loginPassword" type="password" placeholder="Enter your password" />
          </div>
          <div id="signupFields" style="display:none;">
            <div class="form-group">
              <label for="signupUsername">Username</label>
              <input id="signupUsername" type="text" placeholder="Choose a username" maxlength="30" />
              <div class="hint">3-30 characters, letters, numbers, and underscores only</div>
            </div>
            <div class="form-group">
              <label for="signupBio">Bio (Optional)</label>
              <textarea id="signupBio" rows="2" placeholder="Tell us about yourself..." maxlength="200"></textarea>
            </div>
          </div>
          
          <div class="auth-buttons">
            <button id="emailLoginBtn" class="btn primary">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                <path d="M20 4H4C2.9 4 2.01 4.9 2.01 6L2 18C2 19.1 2.9 20 4 20H20C21.1 20 22 19.1 22 18V6C22 4.9 21.1 4 20 4ZM20 8L12 13L4 8V6L12 11L20 6V8Z"/>
              </svg>
              Sign In
            </button>
            
            <div class="auth-divider">
              <span>or</span>
            </div>
            
            <button id="emailRegisterBtn" class="btn ghost">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                <path d="M19 13H13V19H11V13H5V11H11V5H13V11H19V13Z"/>
              </svg>
              Create Account
            </button>
          </div>
        </div>

        <div id="loginError" class="error-msg" style="display:none"></div>
      </div>
    </div>
  </div>

  <div class="app">
    <!-- User Bar -->
    <div id="userBar" class="user-bar" style="display:none">
      <div class="user-info">
        <img id="userAvatar" class="user-avatar" src="" alt="">
        <span class="user-welcome">Welcome, <strong id="currentUser"></strong>!</span>
      </div>
      <div class="user-actions">
        <button id="myProfileBtn" class="btn ghost small">My Profile</button>
        <button id="logoutBtn" class="btn ghost small">Logout</button>
      </div>
    </div>

    <!-- Loading -->
    <div id="loadingApp" class="loading" style="display:none; justify-content:center; padding:40px;">
      <div class="spinner"></div>
      <span>Loading...</span>
    </div>

    <!-- Main App Content -->
    <div id="mainContent" style="display:none">
      <div class="brand">
        <div class="logo" aria-hidden></div>
        <div>
          <h1>ReviewHub</h1>
          <div class="sub">Search or paste Spotify links for albums and singles. Rate 0-10 and share with the community.</div>
        </div>
      </div>

      <div class="tabs">
        <button class="tab active" data-tab="global-feed">üåê Global Feed</button>
        <button class="tab" data-tab="add">‚ûï Add Review</button>
        <button class="tab" data-tab="my-reviews">üìù My Reviews</button>
        <button class="tab" data-tab="about">‚ÑπÔ∏è About</button>
        <span class="right pill" id="statsPill">0 reviews</span>
      </div>

      <!-- Global Feed Tab (Now Default) -->
      <section id="tab-global-feed" style="">
        <div class="card">
          <div class="hd">
            <strong>Global Feed</strong>
            <span class="pill" id="globalCount">0 reviews</span>
          </div>
          <div class="bd">
            <div class="filters">
              <div class="filter-group">
                <input id="globalSearch" type="text" placeholder="Search all reviews..." style="max-width:200px">
              </div>
              <div class="filter-group">
                <select id="globalSortBy">
                  <option value="likes-desc">Most liked</option>
                  <option value="date-desc">Newest first</option>
                  <option value="score-desc">Highest rated</option>
                  <option value="score-asc">Lowest rated</option>
                </select>
              </div>
              <div class="filter-group">
                <select id="globalTypeFilter">
                  <option value="all">All types</option>
                  <option value="album">Albums only</option>
                  <option value="track">Singles only</option>
                </select>
              </div>
              <div class="filter-group">
                <select id="globalGenreFilter">
                  <option value="all">All genres</option>
                </select>
              </div>
            </div>
            <div id="globalReviewsList" class="review-list"></div>
            <div id="globalReviewsEmpty" class="empty" style="display:none">No reviews found.</div>
          </div>
        </div>
      </section>

      <!-- Add Review Tab -->
      <section id="tab-add" class="grid" style="display:none">
        <div class="card">
          <div class="hd"><strong>Add a Review</strong></div>
          <div class="bd">
            <div class="row-1">
              <div>
                <label for="musicSearch">Search for music or paste Spotify link</label>
                <div class="search-container">
                  <input id="musicSearch" type="text" placeholder="Search for albums or singles..." />
                  <div id="searchSuggestions" class="search-suggestions" style="display:none"></div>
                </div>
                <div class="hint">Search by artist, album, or song name. Or paste any Spotify album/track URL.</div>
              </div>
            </div>

            <div class="spacer"></div>

            <div id="selectedMusic" style="display:none">
              <div class="r-card" style="margin-bottom:16px;">
                <img id="selectedCover" class="r-cover" alt="Cover" />
                <div>
                  <div id="selectedTitle" class="r-title"></div>
                  <div id="selectedArtist" class="r-artist"></div>
                  <div class="r-meta">
                    <span id="selectedType" class="tag"></span>
                    <div id="selectedGenres" class="genre-list"></div>
                  </div>
                </div>
              </div>
            </div>

            <div class="spacer"></div>

            <div class="row-1 row">
              <div class="rating">
                <label for="score">Score</label>
                <input id="score" type="range" min="0" max="10" step="0.1" value="7" />
                <span class="pill"><span>Current:</span> <strong id="scoreOut">7.0</strong>/10</span>
              </div>
              <div class="manual-score">
                <label for="manualScore">Or type exact score (0-10.00)</label>
                <input id="manualScore" type="number" min="0" max="10" step="0.01" placeholder="e.g., 8.73" />
                <div class="hint">Up to 2 decimal places (e.g., 7.24, 9.87)</div>
              </div>
            </div>

            <div class="spacer"></div>

            <div class="row-1">
              <div>
                <label for="review">Your review</label>
                <textarea id="review" rows="5" placeholder="What did you think about this music?"></textarea>
              </div>
            </div>

            <div class="spacer"></div>

            <div class="toolbar">
              <button id="saveBtn" class="btn primary">üíæ Save Review</button>
              <button id="clearFormBtn" class="btn ghost">üßπ Clear</button>
            </div>
          </div>
        </div>

        <div class="card">
          <div class="hd"><strong>Preview</strong></div>
          <div class="bd" id="previewPane">
            <div class="empty">Select music to see preview</div>
          </div>
        </div>
      </section>

      <!-- My Reviews Tab -->
      <section id="tab-my-reviews" style="display:none">
        <div class="card">
          <div class="hd">
            <strong>My Reviews</strong>
            <div class="toolbar">
              <button id="shareProfileBtn" class="btn small">üîó Share Profile</button>
              <button id="exportBtn" class="btn small">‚¨áÔ∏è Export</button>
            </div>
          </div>
          <div class="bd">
            <div class="filters">
              <div class="filter-group">
                <input id="mySearch" type="text" placeholder="Search my reviews..." style="max-width:200px">
              </div>
              <div class="filter-group">
                <select id="mySortBy">
                  <option value="date-desc">Newest first</option>
                  <option value="date-asc">Oldest first</option>
                  <option value="score-desc">Highest rated</option>
                  <option value="score-asc">Lowest rated</option>
                  <option value="title-asc">Title A‚ÜíZ</option>
                </select>
              </div>
            </div>
            <div id="myReviewsList" class="review-list"></div>
            <div id="myReviewsEmpty" class="empty" style="display:none">No reviews yet. Add one on the Add Review tab.</div>
          </div>
        </div>
      </section>

      <!-- Profile View Tab -->
      <section id="tab-profile" style="display:none">
        <div class="card">
          <div class="hd">
            <div class="profile-header">
              <img id="profileAvatar" class="profile-avatar" src="" alt="">
              <div class="profile-info">
                <h2 id="profileName"></h2>
                <div id="profileBio" class="profile-bio"></div>
                <div id="profileStats" class="profile-stats"></div>
              </div>
            </div>
            <button id="editProfileBtn" class="btn small" style="display:none">‚úèÔ∏è Edit Profile</button>
          </div>
          <div class="bd">
            <div id="profileReviewsList" class="review-list"></div>
            <div id="profileReviewsEmpty" class="empty" style="display:none">No reviews yet.</div>
          </div>
        </div>
      </section>

      <!-- About Tab -->
      <section id="tab-about" style="display:none">
        <div class="card">
          <div class="hd"><strong>About ReviewHub</strong></div>
          <div class="bd">
            <p><strong>ReviewHub</strong> is a community-driven platform for rating and reviewing music. Create an account to discover and share your thoughts on albums and singles.</p>
            <h3>Features:</h3>
            <ul>
              <li><strong>Spotify Integration:</strong> Search for music or paste Spotify links</li>
              <li><strong>Precise Ratings:</strong> Rate music from 0 to 10.00 with decimal precision</li>
              <li><strong>Community Feed:</strong> Discover reviews from other music lovers</li>
              <li><strong>Comments System:</strong> Engage with other users through comments</li>
              <li><strong>Profile Pages:</strong> View profiles and review collections</li>
              <li><strong>Smart Filtering:</strong> Filter by genre, popularity, rating, and more</li>
              <li><strong>Cloud Sync:</strong> Your reviews are saved and accessible anywhere</li>
            </ul>
            <p>Built with Supabase for real-time data and Spotify Web API for music discovery.</p>
          </div>
        </div>
      </section>
    </div>
  </div>

  <!-- Comments Modal -->
  <div id="commentsModal" class="modal">
    <div class="modal-content modal-large">
      <div class="modal-header">
        <h3>Comments</h3>
        <button class="close-btn" id="closeCommentsModal">&times;</button>
      </div>
      <div class="modal-body">
        <div id="commentsList" class="comments-list"></div>
        <div id="addCommentSection" class="add-comment" style="display:none;">
          <textarea id="newComment" placeholder="Add a comment..." rows="3"></textarea>
          <button id="postCommentBtn" class="btn primary small">Post Comment</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Edit Profile Modal -->
  <div id="editProfileModal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h3>Edit Profile</h3>
        <button class="close-btn" id="closeEditProfileModal">&times;</button>
      </div>
      <div class="modal-body">
        <div class="form-group">
          <label for="editUsername">Username</label>
          <input id="editUsername" type="text" maxlength="30" />
          <div class="hint" id="usernameHint">Can be changed once every 3 days</div>
        </div>
        <div class="form-group">
          <label for="editBio">Bio</label>
          <textarea id="editBio" rows="3" maxlength="200"></textarea>
        </div>
        <div class="form-group">
          <label for="editAvatar">Profile Picture</label>
          <input id="editAvatar" type="file" accept="image/*" />
          <div class="hint">Max 2MB, JPG/PNG/GIF</div>
        </div>
        <button id="saveProfileBtn" class="btn primary">Save Changes</button>
        <div id="profileEditError" class="error-msg" style="display:none"></div>
        <div id="profileEditSuccess" class="success-msg" style="display:none"></div>
      </div>
    </div>
  </div>

  <!-- Share Profile Modal -->
  <div id="shareModal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h3>Share Your Profile</h3>
        <button class="close-btn" id="closeShareModal">&times;</button>
      </div>
      <div class="modal-body">
        <p>Share this link to let others see your reviews:</p>
        <div class="share-link-container">
          <input id="shareLink" type="text" readonly />
          <button id="copyLinkBtn" class="btn small">üìã Copy</button>
        </div>
        <div id="copySuccess" class="success-msg" style="display:none">Link copied to clipboard!</div>
      </div>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <script src="script.js"></script>
</body>
</html>
